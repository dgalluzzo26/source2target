<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Mapper - AI Architecture</title>
    <style>
        :root {
            --primary: #10b981;
            --primary-dark: #059669;
            --secondary: #6366f1;
            --accent: #f59e0b;
            --bg-dark: #0f172a;
            --bg-card: #1e293b;
            --bg-card-hover: #334155;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --border: #334155;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            background: linear-gradient(135deg, var(--bg-dark) 0%, #1a1a2e 100%);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        header {
            text-align: center;
            padding: 3rem 0;
            border-bottom: 1px solid var(--border);
            margin-bottom: 3rem;
        }
        
        header h1 {
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.5rem;
        }
        
        header p {
            color: var(--text-secondary);
            font-size: 1.2rem;
        }
        
        .section {
            margin-bottom: 4rem;
        }
        
        .section-title {
            font-size: 1.8rem;
            color: var(--primary);
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--primary);
            display: inline-block;
        }
        
        /* Three Pillars */
        .pillars {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-top: 2rem;
        }
        
        .pillar {
            background: var(--bg-card);
            border-radius: 16px;
            padding: 2rem;
            border: 1px solid var(--border);
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .pillar:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }
        
        .pillar-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }
        
        .pillar h3 {
            font-size: 1.3rem;
            margin-bottom: 0.5rem;
        }
        
        .pillar-subtitle {
            color: var(--accent);
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 1rem;
        }
        
        .pillar p {
            color: var(--text-secondary);
            margin-bottom: 1rem;
        }
        
        .pillar ul {
            list-style: none;
            padding: 0;
        }
        
        .pillar ul li {
            padding: 0.3rem 0;
            color: var(--text-secondary);
        }
        
        .pillar ul li::before {
            content: "‚Üí ";
            color: var(--primary);
        }
        
        .pillar.primary { border-top: 4px solid var(--primary); }
        .pillar.learning { border-top: 4px solid var(--secondary); }
        .pillar.avoid { border-top: 4px solid #ef4444; }
        
        /* Flow Diagram */
        .flow-container {
            background: var(--bg-card);
            border-radius: 16px;
            padding: 2rem;
            border: 1px solid var(--border);
            overflow-x: auto;
        }
        
        .flow-step {
            display: flex;
            align-items: flex-start;
            margin-bottom: 2rem;
            padding-bottom: 2rem;
            border-bottom: 1px solid var(--border);
        }
        
        .flow-step:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        
        .step-number {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2rem;
            flex-shrink: 0;
            margin-right: 1.5rem;
        }
        
        .step-content h4 {
            font-size: 1.2rem;
            margin-bottom: 0.5rem;
        }
        
        .step-content p {
            color: var(--text-secondary);
        }
        
        .step-visual {
            background: var(--bg-dark);
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.9rem;
            border: 1px solid var(--border);
        }
        
        /* Parallel Searches Visual */
        .parallel-searches {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .search-box {
            background: var(--bg-dark);
            border-radius: 8px;
            padding: 1rem;
            text-align: center;
            border: 2px solid var(--border);
        }
        
        .search-box.semantic { border-color: var(--primary); }
        .search-box.patterns { border-color: var(--secondary); }
        .search-box.rejections { border-color: #ef4444; }
        
        .search-box h5 {
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
        }
        
        .search-box ul {
            list-style: none;
            font-size: 0.8rem;
            color: var(--text-secondary);
        }
        
        /* Data Structure Tables */
        .table-container {
            background: var(--bg-card);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            border: 1px solid var(--border);
            overflow-x: auto;
        }
        
        .table-container h4 {
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .table-container h4 .badge {
            background: var(--accent);
            color: var(--bg-dark);
            padding: 0.2rem 0.6rem;
            border-radius: 4px;
            font-size: 0.7rem;
            font-weight: bold;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        th, td {
            padding: 0.75rem 1rem;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }
        
        th {
            background: var(--bg-dark);
            color: var(--primary);
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.8rem;
            letter-spacing: 0.5px;
        }
        
        td {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }
        
        td code {
            background: var(--bg-dark);
            padding: 0.2rem 0.4rem;
            border-radius: 4px;
            font-family: 'Consolas', monospace;
            font-size: 0.85rem;
            color: var(--accent);
        }
        
        /* Benefits Grid */
        .benefits-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
        }
        
        .benefit {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 1.5rem;
            border: 1px solid var(--border);
        }
        
        .benefit-icon {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }
        
        .benefit h4 {
            font-size: 1rem;
            margin-bottom: 0.5rem;
        }
        
        .benefit p {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }
        
        /* Comparison */
        .comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
        }
        
        .comparison-box {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 1.5rem;
            border: 1px solid var(--border);
        }
        
        .comparison-box.before {
            border-top: 4px solid #ef4444;
        }
        
        .comparison-box.after {
            border-top: 4px solid var(--primary);
        }
        
        .comparison-box h4 {
            margin-bottom: 1rem;
        }
        
        .comparison-box pre {
            background: var(--bg-dark);
            padding: 1rem;
            border-radius: 8px;
            overflow-x: auto;
            font-size: 0.85rem;
        }
        
        /* Footer */
        footer {
            text-align: center;
            padding: 2rem;
            border-top: 1px solid var(--border);
            margin-top: 3rem;
            color: var(--text-secondary);
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .parallel-searches {
                grid-template-columns: 1fr;
            }
            
            .comparison {
                grid-template-columns: 1fr;
            }
            
            header h1 {
                font-size: 1.8rem;
            }
        }
        
        /* Arrow Animation */
        .arrow-down {
            text-align: center;
            font-size: 2rem;
            color: var(--primary);
            margin: 1rem 0;
            animation: bounce 2s infinite;
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(10px); }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üß† Smart Mapper AI Architecture</h1>
            <p>Intelligent Data Field Mapping powered by Vector Search & LLM</p>
        </header>
        
        <!-- Executive Summary -->
        <section class="section">
            <h2 class="section-title">Executive Summary</h2>
            <p style="font-size: 1.1rem; max-width: 900px;">
                Smart Mapper uses <strong>AI and vector search</strong> to intelligently suggest data field mappings 
                from source systems to target schemas. The system learns from historical patterns and user feedback 
                to continuously improve suggestions, including multi-field mappings and transformations.
            </p>
        </section>
        
        <!-- Three Pillars -->
        <section class="section">
            <h2 class="section-title">The Three Pillars of AI Mapping</h2>
            <div class="pillars">
                <div class="pillar primary">
                    <div class="pillar-icon">üéØ</div>
                    <h3>Semantic Fields</h3>
                    <div class="pillar-subtitle">Primary Search</div>
                    <p>"What target fields match these source fields?"</p>
                    <ul>
                        <li>Target field candidates</li>
                        <li>Data type matching</li>
                        <li>Description similarity</li>
                        <li>Always executed</li>
                    </ul>
                </div>
                
                <div class="pillar learning">
                    <div class="pillar-icon">üìö</div>
                    <h3>Mapping Patterns</h3>
                    <div class="pillar-subtitle">Learning Search</div>
                    <p>"How did we map similar fields before?"</p>
                    <ul>
                        <li>Multi-field combinations</li>
                        <li>Transformations used</li>
                        <li>Join patterns</li>
                        <li>Complete context</li>
                    </ul>
                </div>
                
                <div class="pillar avoid">
                    <div class="pillar-icon">üö´</div>
                    <h3>Rejection History</h3>
                    <div class="pillar-subtitle">Avoidance Search</div>
                    <p>"What should we avoid suggesting?"</p>
                    <ul>
                        <li>Previously rejected mappings</li>
                        <li>User feedback reasoning</li>
                        <li>Prevents repeat mistakes</li>
                        <li>Semantic matching</li>
                    </ul>
                </div>
            </div>
        </section>
        
        <!-- Flow Diagram -->
        <section class="section">
            <h2 class="section-title">Complete AI Mapping Flow</h2>
            <div class="flow-container">
                
                <div class="flow-step">
                    <div class="step-number">1</div>
                    <div class="step-content">
                        <h4>User Selects Source Fields</h4>
                        <p>User selects one or more source fields to map to a target</p>
                        <div class="step-visual">
                            ‚òë first_name (STRING) - "Member's legal first name"<br>
                            ‚òë last_name (STRING) - "Member's legal last name"
                        </div>
                    </div>
                </div>
                
                <div class="arrow-down">‚Üì</div>
                
                <div class="flow-step">
                    <div class="step-number">2</div>
                    <div class="step-content">
                        <h4>Build Semantic Query</h4>
                        <p>Combine source field information into a searchable query</p>
                        <div class="step-visual">
                            "SOURCE TABLES: member | SOURCE COLUMNS: first_name, last_name | 
                            DESCRIPTIONS: Member's legal first name, Member's legal last name | 
                            TYPES: STRING, STRING"
                        </div>
                    </div>
                </div>
                
                <div class="arrow-down">‚Üì</div>
                
                <div class="flow-step">
                    <div class="step-number">3</div>
                    <div class="step-content">
                        <h4>Parallel Vector Searches</h4>
                        <p>Search three indexes simultaneously for comprehensive context</p>
                        <div class="parallel-searches">
                            <div class="search-box semantic">
                                <h5>üéØ Semantic Fields</h5>
                                <ul>
                                    <li>full_name</li>
                                    <li>member_name</li>
                                    <li>display_name</li>
                                </ul>
                            </div>
                            <div class="search-box patterns">
                                <h5>üìö Mapping Patterns</h5>
                                <ul>
                                    <li>2 fields ‚Üí name</li>
                                    <li>TRIM + UPPER</li>
                                    <li>SPACE concat</li>
                                </ul>
                            </div>
                            <div class="search-box rejections">
                                <h5>üö´ Rejections</h5>
                                <ul>
                                    <li>ssn ‚Üí full_name</li>
                                    <li>(wrong match!)</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="arrow-down">‚Üì</div>
                
                <div class="flow-step">
                    <div class="step-number">4</div>
                    <div class="step-content">
                        <h4>LLM Reasoning</h4>
                        <p>Foundation Model analyzes all inputs and generates intelligent suggestions</p>
                        <div class="step-visual">
                            <strong>Inputs:</strong> Source fields, target candidates, historical patterns, rejections<br><br>
                            <strong>Outputs:</strong> Ranked suggestions with confidence scores, recommended transformations, 
                            multi-field combination suggestions, human-readable reasoning
                        </div>
                    </div>
                </div>
                
                <div class="arrow-down">‚Üì</div>
                
                <div class="flow-step">
                    <div class="step-number">5</div>
                    <div class="step-content">
                        <h4>Present Suggestions</h4>
                        <p>Display ranked suggestions with explanations to the user</p>
                        <div class="step-visual">
                            <strong>üéØ TOP SUGGESTION (95% confidence)</strong><br>
                            Target: full_name<br>
                            Transformations: TRIM, UPPER<br>
                            Concatenation: SPACE<br><br>
                            "Combine first_name and last_name with space separator. 
                            Apply TRIM and UPPER based on 15 similar past mappings."
                        </div>
                    </div>
                </div>
                
                <div class="arrow-down">‚Üì</div>
                
                <div class="flow-step">
                    <div class="step-number">6</div>
                    <div class="step-content">
                        <h4>Learning Loop</h4>
                        <p>User feedback improves future suggestions</p>
                        <div class="parallel-searches" style="grid-template-columns: 1fr 1fr;">
                            <div class="search-box" style="border-color: var(--primary);">
                                <h5>‚úì Accept</h5>
                                <ul>
                                    <li>Create mapping</li>
                                    <li>Save to mapping_patterns</li>
                                    <li>Available for future learning</li>
                                </ul>
                            </div>
                            <div class="search-box" style="border-color: #ef4444;">
                                <h5>‚úó Reject</h5>
                                <ul>
                                    <li>Record rejection with reason</li>
                                    <li>Vector-indexed</li>
                                    <li>Avoided in future</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                
            </div>
        </section>
        
        <!-- Data Structures -->
        <section class="section">
            <h2 class="section-title">Complete Data Model</h2>
            <p style="color: var(--text-secondary); margin-bottom: 2rem;">
                The Smart Mapper platform uses the following tables to manage source fields, target definitions, mappings, and AI learning.
            </p>
            
            <!-- Table 1: semantic_fields -->
            <div class="table-container">
                <h4>üéØ semantic_fields (Target Field Definitions)</h4>
                <p style="color: var(--text-secondary); margin-bottom: 1rem; font-size: 0.9rem;">
                    Defines available target fields for mapping. Vector-indexed for AI search.
                </p>
                <table>
                    <thead>
                        <tr>
                            <th>Column</th>
                            <th>Type</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>semantic_field_id</code></td>
                            <td>BIGINT (PK)</td>
                            <td>Auto-generated primary key</td>
                        </tr>
                        <tr>
                            <td><code>tgt_table_name</code></td>
                            <td>STRING</td>
                            <td>Target table logical name (e.g., "Member Table")</td>
                        </tr>
                        <tr>
                            <td><code>tgt_table_physical_name</code></td>
                            <td>STRING</td>
                            <td>Target table physical name (e.g., "slv_member")</td>
                        </tr>
                        <tr>
                            <td><code>tgt_column_name</code></td>
                            <td>STRING</td>
                            <td>Target column logical name (e.g., "Full Name")</td>
                        </tr>
                        <tr>
                            <td><code>tgt_column_physical_name</code></td>
                            <td>STRING</td>
                            <td>Target column physical name (e.g., "full_name")</td>
                        </tr>
                        <tr>
                            <td><code>tgt_physical_datatype</code></td>
                            <td>STRING</td>
                            <td>Data type (STRING, INT, DATE, etc.)</td>
                        </tr>
                        <tr>
                            <td><code>tgt_comments</code></td>
                            <td>STRING</td>
                            <td>Description of the target field</td>
                        </tr>
                        <tr>
                            <td><code>domain</code></td>
                            <td>STRING</td>
                            <td>Domain category (claims, member, provider, etc.)</td>
                        </tr>
                        <tr>
                            <td><code>semantic_field</code></td>
                            <td>STRING (computed)</td>
                            <td>üîç Vector-searchable concatenated field</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <!-- Table 2: unmapped_fields -->
            <div class="table-container">
                <h4>üì• unmapped_fields (Source Fields Awaiting Mapping)</h4>
                <p style="color: var(--text-secondary); margin-bottom: 1rem; font-size: 0.9rem;">
                    Source fields uploaded by users that need to be mapped to target fields.
                </p>
                <table>
                    <thead>
                        <tr>
                            <th>Column</th>
                            <th>Type</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>unmapped_field_id</code></td>
                            <td>BIGINT (PK)</td>
                            <td>Auto-generated primary key</td>
                        </tr>
                        <tr>
                            <td><code>src_table_name</code></td>
                            <td>STRING</td>
                            <td>Source table logical name</td>
                        </tr>
                        <tr>
                            <td><code>src_table_physical_name</code></td>
                            <td>STRING</td>
                            <td>Source table physical name</td>
                        </tr>
                        <tr>
                            <td><code>src_column_name</code></td>
                            <td>STRING</td>
                            <td>Source column logical name</td>
                        </tr>
                        <tr>
                            <td><code>src_column_physical_name</code></td>
                            <td>STRING</td>
                            <td>Source column physical name</td>
                        </tr>
                        <tr>
                            <td><code>src_physical_datatype</code></td>
                            <td>STRING</td>
                            <td>Data type (STRING, INT, DATE, etc.)</td>
                        </tr>
                        <tr>
                            <td><code>src_nullable</code></td>
                            <td>STRING</td>
                            <td>Whether nullable (YES/NO)</td>
                        </tr>
                        <tr>
                            <td><code>src_comments</code></td>
                            <td>STRING</td>
                            <td>Description of the source field</td>
                        </tr>
                        <tr>
                            <td><code>domain</code></td>
                            <td>STRING</td>
                            <td>Domain category</td>
                        </tr>
                        <tr>
                            <td><code>uploaded_by</code></td>
                            <td>STRING</td>
                            <td>User who uploaded this field</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <!-- Table 3: mapped_fields -->
            <div class="table-container">
                <h4>‚úÖ mapped_fields (Completed Mappings - Target Side)</h4>
                <p style="color: var(--text-secondary); margin-bottom: 1rem; font-size: 0.9rem;">
                    One record per target field with completed mapping. Links to source fields via mapping_details.
                </p>
                <table>
                    <thead>
                        <tr>
                            <th>Column</th>
                            <th>Type</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>mapped_field_id</code></td>
                            <td>BIGINT (PK)</td>
                            <td>Auto-generated primary key</td>
                        </tr>
                        <tr>
                            <td><code>semantic_field_id</code></td>
                            <td>BIGINT (FK)</td>
                            <td>Reference to semantic_fields</td>
                        </tr>
                        <tr>
                            <td><code>tgt_table_name</code></td>
                            <td>STRING</td>
                            <td>Target table name (denormalized)</td>
                        </tr>
                        <tr>
                            <td><code>tgt_column_name</code></td>
                            <td>STRING</td>
                            <td>Target column name (denormalized)</td>
                        </tr>
                        <tr>
                            <td><code>concat_strategy</code></td>
                            <td>STRING</td>
                            <td>How to combine sources: NONE, SPACE, COMMA, PIPE, CUSTOM</td>
                        </tr>
                        <tr>
                            <td><code>concat_separator</code></td>
                            <td>STRING</td>
                            <td>Custom separator if strategy is CUSTOM</td>
                        </tr>
                        <tr>
                            <td><code>transformation_expression</code></td>
                            <td>STRING</td>
                            <td>Full SQL transformation expression</td>
                        </tr>
                        <tr>
                            <td><code>source_relationship_type</code></td>
                            <td>STRING</td>
                            <td>SINGLE, JOIN, or UNION <span class="badge">NEW</span></td>
                        </tr>
                        <tr>
                            <td><code>confidence_score</code></td>
                            <td>DOUBLE</td>
                            <td>AI confidence (0.0 - 1.0)</td>
                        </tr>
                        <tr>
                            <td><code>mapping_source</code></td>
                            <td>STRING</td>
                            <td>AI, MANUAL, BULK_UPLOAD</td>
                        </tr>
                        <tr>
                            <td><code>ai_reasoning</code></td>
                            <td>STRING</td>
                            <td>AI explanation for suggestion</td>
                        </tr>
                        <tr>
                            <td><code>mapped_by</code></td>
                            <td>STRING</td>
                            <td>User who created/approved mapping</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <!-- Table 4: mapping_details -->
            <div class="table-container">
                <h4>üìã mapping_details (Source Fields in Each Mapping)</h4>
                <p style="color: var(--text-secondary); margin-bottom: 1rem; font-size: 0.9rem;">
                    Individual source fields that contribute to a target mapping. Supports multi-field mappings.
                </p>
                <table>
                    <thead>
                        <tr>
                            <th>Column</th>
                            <th>Type</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>mapping_detail_id</code></td>
                            <td>BIGINT (PK)</td>
                            <td>Auto-generated primary key</td>
                        </tr>
                        <tr>
                            <td><code>mapped_field_id</code></td>
                            <td>BIGINT (FK)</td>
                            <td>Reference to mapped_fields</td>
                        </tr>
                        <tr>
                            <td><code>unmapped_field_id</code></td>
                            <td>BIGINT (FK)</td>
                            <td>Reference to unmapped_fields</td>
                        </tr>
                        <tr>
                            <td><code>src_table_name</code></td>
                            <td>STRING</td>
                            <td>Source table name (denormalized)</td>
                        </tr>
                        <tr>
                            <td><code>src_column_name</code></td>
                            <td>STRING</td>
                            <td>Source column name (denormalized)</td>
                        </tr>
                        <tr>
                            <td><code>field_order</code></td>
                            <td>INT</td>
                            <td>Order in concatenation (1, 2, 3...)</td>
                        </tr>
                        <tr>
                            <td><code>transformations</code></td>
                            <td>STRING</td>
                            <td>Comma-separated transformations (TRIM, UPPER, etc.)</td>
                        </tr>
                        <tr>
                            <td><code>default_value</code></td>
                            <td>STRING</td>
                            <td>Default if source is NULL</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <!-- Table 5: mapping_joins -->
            <div class="table-container">
                <h4>üîó mapping_joins (Join Relationships for Multi-Table Mappings)</h4>
                <p style="color: var(--text-secondary); margin-bottom: 1rem; font-size: 0.9rem;">
                    Defines JOIN conditions when source fields come from multiple tables (horizontal combination).
                </p>
                <table>
                    <thead>
                        <tr>
                            <th>Column</th>
                            <th>Type</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>mapping_join_id</code></td>
                            <td>BIGINT (PK)</td>
                            <td>Auto-generated primary key</td>
                        </tr>
                        <tr>
                            <td><code>mapped_field_id</code></td>
                            <td>BIGINT (FK)</td>
                            <td>Reference to mapped_fields</td>
                        </tr>
                        <tr>
                            <td><code>left_table_name</code></td>
                            <td>STRING</td>
                            <td>Left table in join</td>
                        </tr>
                        <tr>
                            <td><code>left_join_column</code></td>
                            <td>STRING</td>
                            <td>Left table join column</td>
                        </tr>
                        <tr>
                            <td><code>right_table_name</code></td>
                            <td>STRING</td>
                            <td>Right table in join</td>
                        </tr>
                        <tr>
                            <td><code>right_join_column</code></td>
                            <td>STRING</td>
                            <td>Right table join column</td>
                        </tr>
                        <tr>
                            <td><code>join_type</code></td>
                            <td>STRING</td>
                            <td>INNER, LEFT, RIGHT, or FULL</td>
                        </tr>
                        <tr>
                            <td><code>join_order</code></td>
                            <td>INT</td>
                            <td>Order of joins (1, 2, 3...)</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <!-- Table 6: mapping_unions (NEW) -->
            <div class="table-container">
                <h4>‚ö° mapping_unions (Union Relationships for Multi-Table Mappings) <span class="badge">NEW</span></h4>
                <p style="color: var(--text-secondary); margin-bottom: 1rem; font-size: 0.9rem;">
                    Defines UNION conditions when stacking rows from multiple tables (vertical combination).
                </p>
                <table>
                    <thead>
                        <tr>
                            <th>Column</th>
                            <th>Type</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>mapping_union_id</code></td>
                            <td>BIGINT (PK)</td>
                            <td>Auto-generated primary key</td>
                        </tr>
                        <tr>
                            <td><code>mapped_field_id</code></td>
                            <td>BIGINT (FK)</td>
                            <td>Reference to mapped_fields</td>
                        </tr>
                        <tr>
                            <td><code>source_table_name</code></td>
                            <td>STRING</td>
                            <td>Table being unioned</td>
                        </tr>
                        <tr>
                            <td><code>source_column_name</code></td>
                            <td>STRING</td>
                            <td>Column from this table</td>
                        </tr>
                        <tr>
                            <td><code>union_type</code></td>
                            <td>STRING</td>
                            <td>UNION or UNION ALL</td>
                        </tr>
                        <tr>
                            <td><code>union_order</code></td>
                            <td>INT</td>
                            <td>Order in union (1, 2, 3...)</td>
                        </tr>
                        <tr>
                            <td><code>where_clause</code></td>
                            <td>STRING</td>
                            <td>Optional filter (e.g., "year = 2023")</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <!-- Table 7: mapping_patterns (NEW) -->
            <div class="table-container">
                <h4>üìö mapping_patterns (Complete Mapping History for AI Learning) <span class="badge">NEW</span></h4>
                <p style="color: var(--text-secondary); margin-bottom: 1rem; font-size: 0.9rem;">
                    Complete mappings as single rows for vector search. Enables AI to learn from full context.
                </p>
                <table>
                    <thead>
                        <tr>
                            <th>Column</th>
                            <th>Type</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>pattern_id</code></td>
                            <td>BIGINT (PK)</td>
                            <td>Auto-generated primary key</td>
                        </tr>
                        <tr>
                            <td><code>mapped_field_id</code></td>
                            <td>BIGINT (FK)</td>
                            <td>Reference to mapped_fields</td>
                        </tr>
                        <tr>
                            <td><code>source_fields_json</code></td>
                            <td>STRING</td>
                            <td>JSON array of all source fields with details</td>
                        </tr>
                        <tr>
                            <td><code>source_tables</code></td>
                            <td>STRING</td>
                            <td>Comma-separated source tables</td>
                        </tr>
                        <tr>
                            <td><code>source_columns</code></td>
                            <td>STRING</td>
                            <td>Comma-separated source columns</td>
                        </tr>
                        <tr>
                            <td><code>source_descriptions</code></td>
                            <td>STRING</td>
                            <td>Combined source descriptions</td>
                        </tr>
                        <tr>
                            <td><code>source_field_count</code></td>
                            <td>INT</td>
                            <td>Number of source fields</td>
                        </tr>
                        <tr>
                            <td><code>tgt_column_name</code></td>
                            <td>STRING</td>
                            <td>Target column name</td>
                        </tr>
                        <tr>
                            <td><code>transformation_expression</code></td>
                            <td>STRING</td>
                            <td>Full SQL transformation</td>
                        </tr>
                        <tr>
                            <td><code>transformations_applied</code></td>
                            <td>STRING</td>
                            <td>Transformations used (TRIM, UPPER, etc.)</td>
                        </tr>
                        <tr>
                            <td><code>source_relationship_type</code></td>
                            <td>STRING</td>
                            <td>SINGLE, JOIN, or UNION</td>
                        </tr>
                        <tr>
                            <td><code>source_semantic_field</code></td>
                            <td>STRING (computed)</td>
                            <td>üîç Vector-searchable concatenated field</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <!-- Table 8: mapping_feedback -->
            <div class="table-container">
                <h4>üí¨ mapping_feedback (User Feedback on AI Suggestions)</h4>
                <p style="color: var(--text-secondary); margin-bottom: 1rem; font-size: 0.9rem;">
                    Captures user acceptance/rejection of AI suggestions for model improvement.
                </p>
                <table>
                    <thead>
                        <tr>
                            <th>Column</th>
                            <th>Type</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>feedback_id</code></td>
                            <td>BIGINT (PK)</td>
                            <td>Auto-generated primary key</td>
                        </tr>
                        <tr>
                            <td><code>suggested_src_table</code></td>
                            <td>STRING</td>
                            <td>Source table in AI suggestion</td>
                        </tr>
                        <tr>
                            <td><code>suggested_src_column</code></td>
                            <td>STRING</td>
                            <td>Source column in AI suggestion</td>
                        </tr>
                        <tr>
                            <td><code>suggested_tgt_table</code></td>
                            <td>STRING</td>
                            <td>Target table in AI suggestion</td>
                        </tr>
                        <tr>
                            <td><code>suggested_tgt_column</code></td>
                            <td>STRING</td>
                            <td>Target column in AI suggestion</td>
                        </tr>
                        <tr>
                            <td><code>feedback_action</code></td>
                            <td>STRING</td>
                            <td>ACCEPTED, REJECTED, or MODIFIED</td>
                        </tr>
                        <tr>
                            <td><code>user_comments</code></td>
                            <td>STRING</td>
                            <td>User explanation for decision</td>
                        </tr>
                        <tr>
                            <td><code>ai_confidence_score</code></td>
                            <td>DOUBLE</td>
                            <td>AI confidence at time of suggestion</td>
                        </tr>
                        <tr>
                            <td><code>src_comments</code></td>
                            <td>STRING</td>
                            <td>Source description (for vector search) <span class="badge">NEW</span></td>
                        </tr>
                        <tr>
                            <td><code>feedback_by</code></td>
                            <td>STRING</td>
                            <td>User who provided feedback</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <!-- Table 9: transformation_library -->
            <div class="table-container">
                <h4>‚öôÔ∏è transformation_library (Reusable Transformation Templates)</h4>
                <p style="color: var(--text-secondary); margin-bottom: 1rem; font-size: 0.9rem;">
                    Predefined SQL transformations that can be applied to source fields.
                </p>
                <table>
                    <thead>
                        <tr>
                            <th>Column</th>
                            <th>Type</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>transformation_id</code></td>
                            <td>BIGINT (PK)</td>
                            <td>Auto-generated primary key</td>
                        </tr>
                        <tr>
                            <td><code>transformation_name</code></td>
                            <td>STRING</td>
                            <td>Display name (e.g., "Trim Whitespace")</td>
                        </tr>
                        <tr>
                            <td><code>transformation_code</code></td>
                            <td>STRING</td>
                            <td>Short code (e.g., "TRIM")</td>
                        </tr>
                        <tr>
                            <td><code>transformation_expression</code></td>
                            <td>STRING</td>
                            <td>SQL template (e.g., "TRIM({field})")</td>
                        </tr>
                        <tr>
                            <td><code>category</code></td>
                            <td>STRING</td>
                            <td>TEXT, DATE, NUMERIC, CUSTOM</td>
                        </tr>
                        <tr>
                            <td><code>is_system</code></td>
                            <td>BOOLEAN</td>
                            <td>System-provided vs user-created</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>
        
        <!-- Entity Relationship Diagram -->
        <section class="section">
            <h2 class="section-title">Entity Relationships</h2>
            <div class="flow-container" style="text-align: center;">
                <pre style="text-align: left; display: inline-block; font-size: 0.85rem; line-height: 1.4;">
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   unmapped_fields   ‚îÇ         ‚îÇ   semantic_fields   ‚îÇ
‚îÇ   (Source Fields)   ‚îÇ         ‚îÇ   (Target Fields)   ‚îÇ
‚îÇ                     ‚îÇ         ‚îÇ                     ‚îÇ
‚îÇ ‚Ä¢ unmapped_field_id ‚îÇ         ‚îÇ ‚Ä¢ semantic_field_id ‚îÇ
‚îÇ ‚Ä¢ src_table_name    ‚îÇ         ‚îÇ ‚Ä¢ tgt_table_name    ‚îÇ
‚îÇ ‚Ä¢ src_column_name   ‚îÇ         ‚îÇ ‚Ä¢ tgt_column_name   ‚îÇ
‚îÇ ‚Ä¢ src_comments      ‚îÇ         ‚îÇ ‚Ä¢ tgt_comments      ‚îÇ
‚îÇ ‚Ä¢ src_datatype      ‚îÇ         ‚îÇ ‚Ä¢ semantic_field üîç ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ                               ‚îÇ
           ‚îÇ FK: unmapped_field_id         ‚îÇ FK: semantic_field_id
           ‚îÇ                               ‚îÇ
           ‚ñº                               ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                   mapped_fields                      ‚îÇ
‚îÇ               (Completed Mappings)                   ‚îÇ
‚îÇ                                                      ‚îÇ
‚îÇ ‚Ä¢ mapped_field_id (PK)                              ‚îÇ
‚îÇ ‚Ä¢ semantic_field_id (FK) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚Üí ‚îÇ
‚îÇ ‚Ä¢ concat_strategy                                    ‚îÇ
‚îÇ ‚Ä¢ transformation_expression                          ‚îÇ
‚îÇ ‚Ä¢ source_relationship_type (SINGLE/JOIN/UNION)      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                       ‚îÇ
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚îÇ              ‚îÇ              ‚îÇ                ‚îÇ
        ‚ñº              ‚ñº              ‚ñº                ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇmapping_details‚îÇ ‚îÇmapping_   ‚îÇ ‚îÇmapping_   ‚îÇ ‚îÇ mapping_       ‚îÇ
‚îÇ               ‚îÇ ‚îÇjoins      ‚îÇ ‚îÇunions     ‚îÇ ‚îÇ patterns üîç    ‚îÇ
‚îÇ ‚Ä¢ field_order ‚îÇ ‚îÇ           ‚îÇ ‚îÇ           ‚îÇ ‚îÇ                ‚îÇ
‚îÇ ‚Ä¢ transforms  ‚îÇ ‚îÇ ‚Ä¢ join_   ‚îÇ ‚îÇ ‚Ä¢ union_  ‚îÇ ‚îÇ ‚Ä¢ source_      ‚îÇ
‚îÇ ‚Ä¢ src_column  ‚îÇ ‚îÇ   type    ‚îÇ ‚îÇ   type    ‚îÇ ‚îÇ   semantic_    ‚îÇ
‚îÇ               ‚îÇ ‚îÇ ‚Ä¢ left/   ‚îÇ ‚îÇ ‚Ä¢ union_  ‚îÇ ‚îÇ   field        ‚îÇ
‚îÇ               ‚îÇ ‚îÇ   right   ‚îÇ ‚îÇ   order   ‚îÇ ‚îÇ ‚Ä¢ source_      ‚îÇ
‚îÇ               ‚îÇ ‚îÇ   tables  ‚îÇ ‚îÇ           ‚îÇ ‚îÇ   fields_json  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚îÇ  mapping_feedback   ‚îÇ
                    ‚îÇ                     ‚îÇ
                    ‚îÇ ‚Ä¢ feedback_action   ‚îÇ
                    ‚îÇ ‚Ä¢ user_comments     ‚îÇ
                    ‚îÇ ‚Ä¢ src_comments üîç   ‚îÇ
                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

üîç = Vector-indexed for AI search
                </pre>
            </div>
        </section>
        
        <!-- Why This Architecture -->
        <section class="section">
            <h2 class="section-title">Why This Architecture?</h2>
            <div class="comparison">
                <div class="comparison-box before">
                    <h4>‚ùå Previous Limitation</h4>
                    <p style="color: var(--text-secondary); margin-bottom: 1rem;">
                        Only captured column pairs, missing context
                    </p>
                    <pre>first_name ‚Üí full_name

Missing:
‚Ä¢ Multi-field combinations
‚Ä¢ Transformations applied
‚Ä¢ Join conditions
‚Ä¢ The complete "recipe"</pre>
                </div>
                <div class="comparison-box after">
                    <h4>‚úÖ New Approach</h4>
                    <p style="color: var(--text-secondary); margin-bottom: 1rem;">
                        Captures complete patterns
                    </p>
                    <pre>{
  "sources": ["first_name", "last_name"],
  "target": "full_name",
  "transformations": ["TRIM", "UPPER"],
  "concat": "SPACE",
  "expression": "CONCAT(...)"
}</pre>
                </div>
            </div>
        </section>
        
        <!-- Benefits -->
        <section class="section">
            <h2 class="section-title">Benefits</h2>
            <div class="benefits-grid">
                <div class="benefit">
                    <div class="benefit-icon">üéØ</div>
                    <h4>Accurate Suggestions</h4>
                    <p>Vector search finds semantically similar fields, not just name matches</p>
                </div>
                <div class="benefit">
                    <div class="benefit-icon">üìö</div>
                    <h4>Historical Learning</h4>
                    <p>AI learns from complete past mappings, not just column pairs</p>
                </div>
                <div class="benefit">
                    <div class="benefit-icon">üîÑ</div>
                    <h4>Multi-Field Support</h4>
                    <p>Recognizes when fields should be combined (joins or unions)</p>
                </div>
                <div class="benefit">
                    <div class="benefit-icon">‚ö°</div>
                    <h4>Transformation Hints</h4>
                    <p>Suggests TRIM, UPPER, etc. based on history</p>
                </div>
                <div class="benefit">
                    <div class="benefit-icon">üö´</div>
                    <h4>Mistake Avoidance</h4>
                    <p>Won't repeat previously rejected suggestions</p>
                </div>
                <div class="benefit">
                    <div class="benefit-icon">üîç</div>
                    <h4>Cross-System Matching</h4>
                    <p>Works even when source systems have different naming conventions</p>
                </div>
            </div>
        </section>
        
        <!-- Tech Stack -->
        <section class="section">
            <h2 class="section-title">Technology Stack</h2>
            <div class="benefits-grid" style="grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));">
                <div class="benefit" style="text-align: center;">
                    <div class="benefit-icon">üîé</div>
                    <h4>Vector Search</h4>
                    <p>Databricks Vector Search</p>
                </div>
                <div class="benefit" style="text-align: center;">
                    <div class="benefit-icon">ü§ñ</div>
                    <h4>LLM</h4>
                    <p>Databricks Foundation Model</p>
                </div>
                <div class="benefit" style="text-align: center;">
                    <div class="benefit-icon">üíæ</div>
                    <h4>Database</h4>
                    <p>Delta Lake</p>
                </div>
                <div class="benefit" style="text-align: center;">
                    <div class="benefit-icon">‚öôÔ∏è</div>
                    <h4>Backend</h4>
                    <p>FastAPI (Python)</p>
                </div>
                <div class="benefit" style="text-align: center;">
                    <div class="benefit-icon">üñ•Ô∏è</div>
                    <h4>Frontend</h4>
                    <p>Vue 3 + PrimeVue</p>
                </div>
            </div>
        </section>
        
        <footer>
            <p>Smart Mapper - Intelligent Data Field Mapping</p>
            <p style="font-size: 0.9rem; margin-top: 0.5rem;">Powered by Databricks AI</p>
        </footer>
    </div>
</body>
</html>


tgt_column_physical_name,join_metadata
MBR_CNTCT_SSK,"{
  ""patternType"": ""UNION_JOIN"",
  ""outputColumn"": ""MBR_CNTCT_SSK"",
  ""description"": ""Maps MBR_CNTCT_SSK from ENTITY and MBR_FNDTN tables"",
  ""silverTables"": [
    {""alias"": ""mf"", ""physicalName"": ""oz_dev.silver_dmes_de.mbr_fndtn"", ""isConstant"": true, ""description"": ""Member foundation table""},
    {""alias"": ""c"", ""physicalName"": ""oz_dev.silver_dmes_de.cnty_cd"", ""isConstant"": true, ""description"": ""County code table""}
  ],
  ""unionBranches"": [
    {
      ""branchId"": 1,
      ""description"": ""Maps MBR_CNTCT_SSK from t_re_base table"",
      ""bronzeTable"": {""alias"": ""b"", ""physicalName"": ""oz_dev.bronze_dmes_de.t_re_base"", ""isConstant"": false},
      ""joins"": [
        {""type"": ""INNER"", ""toTable"": ""mf"", ""onCondition"": ""b.SAK_RECIP = mf.SRC_KEY_ID AND b.CURR_REC_IND=1""},
        {""type"": ""LEFT"", ""toTable"": ""c"", ""onCondition"": ""b.CDE_COUNTY = c.CNTY_ID AND c.CURR_REC_IND=1""}
      ],
      ""whereClause"": ""mf.CURR_REC_IND=1""
    },
    {
      ""branchId"": 2,
      ""description"": ""Maps MBR_CNTCT_SSK from t_re_multi_address table"",
      ""bronzeTable"": {""alias"": ""a"", ""physicalName"": ""oz_dev.bronze_dmes_de.t_re_multi_address"", ""isConstant"": false},
      ""joins"": [
        {""type"": ""INNER"", ""toTable"": ""mf"", ""onCondition"": ""a.SAK_RECIP = mf.SRC_KEY_ID""},
        {""type"": ""LEFT"", ""toTable"": ""c"", ""onCondition"": ""a.CDE_COUNTY = c.CNTY_ID AND c.CURR_REC_IND=1""}
      ],
      ""whereClause"": ""mf.CURR_REC_IND=1 AND trim(a.CDE_ADDR_USAGE) in (R,M) AND a.CURR_REC_IND=1""
    }
  ],
  ""userColumnsToMap"": [
    {""role"": ""join_key"", ""originalColumn"": ""SAK_RECIP"", ""description"": ""Recipient ID""},
    {""role"": ""output"", ""originalColumn"": ""TENANT_CD"", ""description"": ""Tenant code""},
    {""role"": ""output"", ""originalColumn"": ""SRC_SYS_CD"", ""description"": ""Source system code""},
    {""role"": ""output"", ""originalColumn"": ""MBR_SK"", ""description"": ""Member ID""},
    {""role"": ""output"", ""originalColumn"": ""CNTCT_TYP_CD"", ""description"": ""Contact type code""},
    {""role"": ""filter"", ""originalColumn"": ""CURR_REC_IND"", ""description"": ""Current record indicator""},
    {""role"": ""filter"", ""originalColumn"": ""CDE_ADDR_USAGE"", ""description"": ""Address usage code""}
  ],
  ""userTablesToMap"": [
    {""role"": ""bronze_primary"", ""originalTable"": ""t_re_base"", ""description"": ""Entity table""},
    {""role"": ""bronze_secondary"", ""originalTable"": ""t_re_multi_address"", ""description"": ""Entity address table""}
  ]
}"
SRC_CD,"{
  ""patternType"": ""UNION_JOIN"",
  ""outputColumn"": ""SRC_CD"",
  ""description"": ""Maps source address codes from T_RE_BASE and T_RE_MULTI_ADDRESS tables to MBR_CNTCT table"",
  ""silverTables"": [
    {""alias"": ""mf"", ""physicalName"": ""oz_dev.silver_dmes_de.mbr_fndtn"", ""isConstant"": true, ""description"": ""Member foundation table""},
    {""alias"": ""c"", ""physicalName"": ""oz_dev.silver_dmes_de.cnty_cd"", ""isConstant"": true, ""description"": ""County code table""}
  ],
  ""unionBranches"": [
    {
      ""branchId"": 1,
      ""description"": ""Maps source address codes from T_RE_BASE table"",
      ""bronzeTable"": {""alias"": ""b"", ""physicalName"": ""oz_dev.bronze_dmes_de.t_re_base"", ""isConstant"": false},
      ""joins"": [
        {""type"": ""INNER"", ""toTable"": ""mf"", ""onCondition"": ""b.SAK_RECIP = mf.SRC_KEY_ID AND b.CURR_REC_IND=1""},
        {""type"": ""LEFT"", ""toTable"": ""c"", ""onCondition"": ""b.CDE_COUNTY = c.CNTY_ID AND c.CURR_REC_IND=1""}
      ],
      ""whereClause"": ""mf.CURR_REC_IND=1""
    },
    {
      ""branchId"": 2,
      ""description"": ""Maps source address codes from T_RE_MULTI_ADDRESS table"",
      ""bronzeTable"": {""alias"": ""a"", ""physicalName"": ""oz_dev.bronze_dmes_de.t_re_multi_address"", ""isConstant"": false},
      ""joins"": [
        {""type"": ""INNER"", ""toTable"": ""mf"", ""onCondition"": ""a.SAK_RECIP = mf.SRC_KEY_ID""},
        {""type"": ""LEFT"", ""toTable"": ""c"", ""onCondition"": ""a.CDE_COUNTY = c.CNTY_ID AND c.CURR_REC_IND=1""}
      ],
      ""whereClause"": ""mf.CURR_REC_IND=1 AND trim(a.CDE_ADDR_USAGE) IN (R,M) AND a.CURR_REC_IND=1""
    }
  ],
  ""userColumnsToMap"": [
    {""role"": ""output"", ""originalColumn"": ""CDE_SOURCE_ADDR"", ""description"": ""Source address code from T_RE_BASE table""},
    {""role"": ""output"", ""originalColumn"": ""CDE_SOURCE"", ""description"": ""Source address code from T_RE_MULTI_ADDRESS table""},
    {""role"": ""join_key"", ""originalColumn"": ""SAK_RECIP"", ""description"": ""Recipient ID for joining with mbr_fndtn table""},
    {""role"": ""join_key"", ""originalColumn"": ""CDE_COUNTY"", ""description"": ""County code for joining with cnty_cd table""},
    {""role"": ""filter"", ""originalColumn"": ""CURR_REC_IND"", ""description"": ""Current record indicator for filtering""},
    {""role"": ""filter"", ""originalColumn"": ""CDE_ADDR_USAGE"", ""description"": ""Address usage code for filtering T_RE_MULTI_ADDRESS table""}
  ],
  ""userTablesToMap"": [
    {""role"": ""bronze_primary"", ""originalTable"": ""t_re_base"", ""description"": ""Table containing base address information""},
    {""role"": ""bronze_secondary"", ""originalTable"": ""t_re_multi_address"", ""description"": ""Table containing multiple address information""}
  ]
}"
ZIP_CD_4,"{
  ""patternType"": ""UNION_JOIN"",
  ""outputColumn"": ""ZIP_CD_4"",
  ""description"": ""Maps ZIP_CD_4 from T_RE_BASE and T_RE_MULTI_ADDRESS to MBR_CNTCT"",
  ""silverTables"": [
    {""alias"": ""mf"", ""physicalName"": ""oz_dev.silver_dmes_de.mbr_fndtn"", ""isConstant"": true, ""description"": ""Member foundation table""},
    {""alias"": ""c"", ""physicalName"": ""oz_dev.silver_dmes_de.cnty_cd"", ""isConstant"": true, ""description"": ""County code table""}
  ],
  ""unionBranches"": [
    {
      ""branchId"": 1,
      ""description"": ""Maps ZIP_CD_4 from T_RE_BASE"",
      ""bronzeTable"": {""alias"": ""b"", ""physicalName"": ""oz_dev.bronze_dmes_de.t_re_base"", ""isConstant"": false},
      ""joins"": [
        {""type"": ""INNER"", ""toTable"": ""mf"", ""onCondition"": ""b.SAK_RECIP = mf.SRC_KEY_ID AND b.CURR_REC_IND=1""},
        {""type"": ""LEFT"", ""toTable"": ""c"", ""onCondition"": ""b.CDE_COUNTY = c.CNTY_ID AND c.CURR_REC_IND=1""}
      ],
      ""whereClause"": ""mf.CURR_REC_IND=1""
    },
    {
      ""branchId"": 2,
      ""description"": ""Maps ZIP_CD_4 from T_RE_MULTI_ADDRESS"",
      ""bronzeTable"": {""alias"": ""a"", ""physicalName"": ""oz_dev.bronze_dmes_de.t_re_multi_address"", ""isConstant"": false},
      ""joins"": [
        {""type"": ""INNER"", ""toTable"": ""mf"", ""onCondition"": ""a.SAK_RECIP = mf.SRC_KEY_ID""},
        {""type"": ""LEFT"", ""toTable"": ""c"", ""onCondition"": ""a.CDE_COUNTY = c.CNTY_ID AND c.CURR_REC_IND=1""}
      ],
      ""whereClause"": ""trim(a.CDE_ADDR_USAGE) in (R,M) AND a.CURR_REC_IND=1 AND mf.CURR_REC_IND=1""
    }
  ],
  ""userColumnsToMap"": [
    {""role"": ""output"", ""originalColumn"": ""ADR_ZIP_CODE_4"", ""description"": ""ZIP code column""},
    {""role"": ""join_key"", ""originalColumn"": ""SAK_RECIP"", ""description"": ""Recipient key column""},
    {""role"": ""join_key"", ""originalColumn"": ""CDE_COUNTY"", ""description"": ""County code column""},
    {""role"": ""filter"", ""originalColumn"": ""CURR_REC_IND"", ""description"": ""Current record indicator column""},
    {""role"": ""filter"", ""originalColumn"": ""CDE_ADDR_USAGE"", ""description"": ""Address usage code column""}
  ],
  ""userTablesToMap"": [
    {""role"": ""bronze_primary"", ""originalTable"": ""T_RE_BASE"", ""description"": ""Real estate base table""},
    {""role"": ""bronze_secondary"", ""originalTable"": ""T_RE_MULTI_ADDRESS"", ""description"": ""Real estate multi-address table""}
  ]
}"
